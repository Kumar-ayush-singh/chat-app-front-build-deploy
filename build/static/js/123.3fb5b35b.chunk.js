"use strict";(self.webpackChunkchat=self.webpackChunkchat||[]).push([[123],{8123:function(n,e,t){t.r(e),t.d(e,{default:function(){return bn}});var r,i,a,s,o,c,d=t(168),l=t(2791),h=t(6444),x=t(9439),p=t(9434),u=t(4165),g=t(5861),m=t(1912),f=t(8077),v=h.ZP.section(r||(r=(0,d.Z)(["\n\n  --thm-online-status-color: var(--thm-primary-color);\n  --thm-selected-chat-color: linear-gradient(300deg, var(--thm-primary-color), var(--thm-secondary-color));\n\n  margin-bottom: 5px;\n  @media (max-width: 950px){\n    margin: 0;\n  }\n\n  .card {\n    display: flex;\n    align-items: center;\n    gap: 10px;\n    background-color: var(--thm-transparent-color);\n    border-radius: 15px;\n    padding: 15px 20px;\n    // box-shadow: 0px 0px 2px var(--thm-background-color) inset;\n    // position: relative;\n\n    @media(max-width: 950px){\n      background-color: transparent;\n      padding: 10px;\n    }\n\n    &:hover{\n      background: var(--thm-transparent2-color);\n    }\n    &.active{\n      @media (min-width: 750px){\n        background: var(--thm-selected-chat-color);\n      }\n    }\n\n    &>div.img-notification-container {\n      height: max-content;\n      width: max-content;\n      position: relative;\n\n      img{\n        width: 50px;\n        height: 50px;\n        width: 50px;\n        border-radius: 50%;\n      }\n\n      div{\n        position: absolute;\n        top: 0;\n        right: 0;\n        width: 20px;\n        height: 20px;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        border-radius: 50%;\n        color: black;\n        font-weight: bold;\n        background: yellow;\n      }\n    }\n\n    &>div.card-info{\n      flex-grow: 1;\n      display: flex;\n      flex-direction: column;\n      gap: 4px;\n      overflow: hidden;\n\n      h5{\n        margin: 0;\n        text-overflow: ellipsis;\n        overflow: hidden;\n        white-space: nowrap;\n      }\n\n      span{\n        font-size: 12px;\n        color: #d5d5d5;\n        overflow: hidden;\n        text-overflow: ellipsis;\n        white-space: nowrap;\n        font-weight: 500;\n      }\n\n      &.new-message{\n        font-weight: bold;\n      }\n    }\n\n    &>span, div.img-notification-container{\n      display: block;\n      flex-shrink: 0;\n      flex-grow: 0;\n    }\n    \n    &>span.online{\n      width: 12px;\n      height: 12px;\n      border-radius: 50%;\n\n      background: var(--thm-online-status-color);\n    }\n  }\n"]))),w=t(6118),j=t(8772),b=t(6247),y=t(7215),k=t(184),Z=function(n){var e=(0,p.I0)(),t=(0,p.v9)((function(n){return n.user})).user,r=(0,p.v9)((function(n){return n.chat})).currentChat,i=(0,p.v9)((function(n){return n.realTime})),a=i.onlineUsers,s=i.chatNotifications;(0,l.useEffect)((function(){e((0,w.at)({chatId:n.chat._id,lastMessage:n.chat.lastMessage||{},newMsgCount:n.chat.lastMessage&&n.chat.lastMessage.senderId!==t.userId?n.chat.unreadMsgCount:0,lastViewedMessage:n.chat.lastViewedMessage||{},dataFromDB:!0}))}),[n.chat]);var o=n.chat._id===r.Id;return(0,k.jsx)(v,{children:(0,k.jsxs)("div",{className:(o?"active":"")+" card",onClick:function(){s[n.chat._id]&&0===s[n.chat._id].newMsgCount&&e((0,w.tk)(n.chat._id)),e((0,f.h$)({name:n.chat.otherMember.name,Id:n.chat.otherMember._id,avatar:n.chat.otherMember.avatar})),e((0,f.YQ)({chatId:n.chat._id,userId:t.userId})),e((0,b.Lb)("currentChatContainer")),s[n.chat._id]&&s[n.chat._id].newMsgCount&&(e((0,w.zF)(n.chat._id)),j.Z.emit("message-viewed",n.chat._id,n.chat.lastMessage._id,(function(n){console.log("Viewed message id is send to server and get response status ".concat(n.status))})))},children:[(0,k.jsxs)("div",{className:"img-notification-container",children:[(0,k.jsx)("img",{src:(0,y.Z)(n.chat.otherMember.avatar),alt:""}),s[n.chat._id]&&s[n.chat._id].newMsgCount>=1?(0,k.jsx)("div",{children:s[n.chat._id].newMsgCount}):null]}),(0,k.jsxs)("div",{className:"card-info new-message",children:[(0,k.jsx)("h5",{children:n.chat.otherMember.name}),s[n.chat._id]&&s[n.chat._id].lastMessage.text?(0,k.jsx)("span",{children:s[n.chat._id].lastMessage.text}):null]}),(0,k.jsx)("span",{className:a[n.chat.otherMember._id]?"online":"offline"})]})})},N=t(6719),I=t(9341),C=t(5033),M=t(8610),_=h.ZP.div(i||(i=(0,d.Z)(["\nheight: 100%;\n\n    .chat404{\n        width: 100%;\n        height: 100%;\n        display: flex;\n        justify-content: center;\n        align-items: center;\n        padding: 30px;\n        border-radius: 15px;\n        background: linear-gradient(var(--thm-transparent-color), transparent);\n        font-weight: 500;\n\n\n        &>div.no-chat{\n            width: 100%;\n            padding: 20px;\n            margin-top: -50px;\n            text-align: center;\n            background: var(--thm-transparent-color);\n            border-radius: 10px;\n            \n            button{\n                margin-top: 15px;\n                background: var(--thm-gradient);\n                outline: none;\n                border: none;\n                border-radius: 5px;\n                padding: 10px 20px;\n                cursor: pointer;\n                font-weight: inherit;\n            }\n        }\n    }\n"]))),P=function(n){var e=n.search,t=(0,p.I0)(),r=(0,p.v9)((function(n){return n.user})).user,i=(0,l.useState)(!0),a=(0,x.Z)(i,2),s=a[0],o=a[1],c=(0,p.v9)((function(n){return n.chat})),d=c.allChats,h=c.newChat,v=function(){var n=(0,g.Z)((0,u.Z)().mark((function n(){var e,i,a;return(0,u.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,e=(0,N.LP)()){n.next=5;break}return t(I.ne),n.abrupt("return");case 5:return n.next=7,m.Z.get("".concat(C.L,"/api/chat/").concat(r.userId),{headers:{Authorization:"Bearer ".concat(e)}});case 7:i=n.sent,a=i.data,o(!1),t((0,f.uE)(a)),console.log("All Chats of user : "),console.log(a),n.next=17;break;case 15:n.prev=15,n.t0=n.catch(0);case 17:case"end":return n.stop()}}),n,null,[[0,15]])})));return function(){return n.apply(this,arguments)}}();(0,l.useEffect)((function(){v()}),[h]);return(0,k.jsx)(k.Fragment,{children:(0,k.jsx)(_,{children:0===d.length?(0,k.jsx)("div",{className:"chat404",children:s?(0,k.jsx)(M.Z,{height:"100%"}):(0,k.jsxs)("div",{className:"no-chat",children:[(0,k.jsx)("div",{children:"No Chat Available."}),(0,k.jsx)("button",{onClick:function(){t((0,b.XU)("searchUsers"))},children:"Start New"})]})}):d.map((function(n,t){return String(n.otherMember.name).toLowerCase().includes(e)?(0,k.jsx)(Z,{chat:n},t):null}))})})},z=t(6355),F=h.ZP.section(a||(a=(0,d.Z)(["\n  .chat-card {\n    display: flex;\n    align-items: center;\n    gap: 2rem;\n    border-radius: 20px 20px;\n    margin: 5px 1rem;\n    background-color: white;\n    padding: 0.5rem;\n    .icon {\n      font-size: 2rem;\n    }\n  }\n"]))),S=function(){return(0,k.jsx)(F,{children:(0,k.jsxs)("div",{className:"chat-card",children:[(0,k.jsx)("div",{className:"icon",children:(0,k.jsx)(z.qc7,{})}),(0,k.jsx)("h5",{children:"group name"})]})})},U=h.ZP.section(s||(s=(0,d.Z)(["\n\n"]))),L=function(){return(0,k.jsx)(U,{children:(0,k.jsx)(S,{})})},T=function(n){var e=n.name,t=n.Id,r=n.avatar,i=(0,p.I0)(),a=(0,p.v9)((function(n){return n.user})).user,s=(0,p.v9)((function(n){return n.realTime})).onlineUsers,o=function(){var n=(0,g.Z)((0,u.Z)().mark((function n(){var s,o,c;return(0,u.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,(s=(0,N.LP)())||i((0,I.ne)()),console.log(a),n.next=6,m.Z.post("".concat(C.L,"/api/chat"),{senderId:a.userId,receiverId:t},{headers:{Authorization:"Bearer ".concat(s)}});case 6:o=n.sent,c=o.data,i((0,f.YQ)({chatId:c._id,userId:a.userId})),i((0,w.at)({chatId:c._id,dataFromDB:!0,newMsgCount:0,lastMessage:{},lastViewedMessage:{}})),i((0,b.XU)("recentChats")),i((0,f.h$)({name:e,Id:t,avatar:r})),i((0,b.Lb)("currentChatContainer")),n.next=18;break;case 15:n.prev=15,n.t0=n.catch(0),console.log(n.t0);case 18:case"end":return n.stop()}}),n,null,[[0,15]])})));return function(){return n.apply(this,arguments)}}();return(0,k.jsx)(v,{children:(0,k.jsxs)("div",{className:"card",onClick:o,children:[(0,k.jsx)("div",{className:"img-notification-container",children:(0,k.jsx)("img",{src:(0,y.Z)(r),alt:""})}),(0,k.jsx)("div",{className:"card-info",children:(0,k.jsx)("h5",{children:e})}),(0,k.jsx)("span",{className:s[t]?"online":"offline"})]})})},A=h.ZP.section(o||(o=(0,d.Z)(["\n  height: 100%;\n  .user404{\n    width: 100%;\n    height: 100%;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    padding: 30px;\n    border-radius: 15px;\n    background: linear-gradient(var(--thm-transparent-color), transparent);\n    font-weight: 500;\n  }\n"]))),E=function(n){var e=n.search,t=(0,p.v9)((function(n){return n.user})).user,r=(0,p.v9)((function(n){return n.chat})).allUsers,i=(0,l.useState)(!0),a=(0,x.Z)(i,2),s=a[0],o=a[1],c=(0,p.I0)(),d=function(){var n=(0,g.Z)((0,u.Z)().mark((function n(){var e,t,r;return(0,u.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e=(0,N.LP)()){n.next=4;break}return c((0,I.ne)()),n.abrupt("return");case 4:return n.next=6,m.Z.get("".concat(C.L,"/api/user/get-all/"),{headers:{Authorization:"Bearer ".concat(e)}});case 6:t=n.sent,r=t.data,c((0,f.BA)(r)),o(!1),console.log("All users : "),console.log(r);case 12:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();return(0,l.useEffect)((function(){d()}),[]),(0,k.jsx)(A,{children:s&&!r.length?(0,k.jsx)("div",{className:"user404",children:(0,k.jsx)(M.Z,{height:"100%"})}):(0,k.jsx)(k.Fragment,{children:r.map((function(n,r){var i=n.name,a=n._id,s=n.avatar;return a===t.userId?null:String(i).toLowerCase().includes(e)?(0,k.jsx)(T,{name:i,Id:a,avatar:s},r):null}))})})},V=t(9126),B=t(3853),D=t(7689),R=t(1087),$=t(7692);function X(){var n=(0,p.v9)((function(n){return n.chatNav})).chatSection,e=(0,p.I0)(),t=(0,D.s0)();function r(n){e((0,b.XU)(n))}return(0,k.jsxs)(H,{className:"chatNavBar",children:[(0,k.jsxs)("ul",{children:[(0,k.jsx)("li",{className:"groupChats"===n?"active":"",onClick:function(){r("groupChats")},children:(0,k.jsx)($.p$$,{})}),(0,k.jsx)("li",{className:"recentChats"===n?"active":"",onClick:function(){r("recentChats")},children:(0,k.jsx)(V.i0Y,{})}),(0,k.jsx)("li",{className:"searchUsers"===n?"active":"",onClick:function(){r("searchUsers")},children:(0,k.jsx)($.EDj,{})})]}),(0,k.jsxs)("div",{className:"high-order-buttons",children:[(0,k.jsx)("button",{className:"home",children:(0,k.jsx)(R.rU,{to:"/",children:(0,k.jsx)(z.xng,{})})}),(0,k.jsx)("button",{className:"log-out",onClick:function(){e((0,I.ne)()),t("/")},children:(0,k.jsx)(R.rU,{to:"/",children:(0,k.jsx)($.TPb,{})})})]})]})}var Y,q,H=h.ZP.nav(c||(c=(0,d.Z)(['\n\n&.chatNavBar {\n    --container-width: 80px;\n    width: var(--container-width);\n    height: 100%;\n    display: flex;\n    align-items: center;\n    position: relative;\n\n    @media (max-width: 950px){\n        width: 100%;\n    }\n\n    ul {\n      display: flex;\n      flex-direction: column;\n      width: 100%;\n\n      @media (max-width: 950px){\n        flex-direction: row;\n        justify-content: space-between;\n      }\n\n      li{\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        padding: 10px 20px;\n        margin: 10px 0px;\n        cursor: pointer;\n        position: relative;\n\n        @media (max-width: 950px){\n            margin: 0px;\n            padding: 10px;\n        }\n\n        &, *{\n          transition: 0.2s ease;\n        }\n\n        svg{\n          width: var(--container-width);\n          height: 25px;\n          transform: scale(1);\n          transform-origin: center center;\n        }\n\n        &.active, &:hover{\n          svg{\n            transform: scale(1.2);\n          }\n        }\n        \n        &.active{\n          @media (max-width: 950px){\n            margin-top: -15px;\n          }\n\n          svg{\n            fill: var(--thm-svg-active-color);\n          }\n\n          &::after{\n            top: 0;\n            height: 100%;\n\n            @media(max-width: 950px){\n                height: 3px;\n                left: 0;\n                top: unset;\n                width: 100%;\n            }\n          }\n\n        }\n        &::after{\n          content: "";\n          position: absolute;\n          display: block;\n          background: var(--thm-svg-active-color);\n          top: 50%;\n          left: 0px;\n          width: 5px;\n          border-radius: 3px;\n          height: 0px;\n          transition: 0.2s linear;\n\n\n          @media (max-width: 950px){\n            top: unset;\n            bottom: 0px;\n            left: 50%;\n            height: 3px;\n            width: 0px;\n          }\n        }\n      }\n    }\n\n    .high-order-buttons{\n      position: absolute;\n      bottom: 0px;\n      left: 0px;\n      width: var(--container-width);\n      padding: 8px;\n\n      @media (max-width: 950px){\n        display: none;\n      }\n\n\n      .home{\n        width: 100%;\n        height: 40px;\n        padding: 5px;\n        margin-bottom: 5px;\n        background: transparent;\n        border: none;\n        outline: none;\n\n        svg{\n          height: 100%;\n          width: 100%;\n          cursor: pointer;\n        }\n      }\n\n      .log-out{\n        height: 40px;\n        width: 100%;\n        background: #fbd547;\n        border-radius: 5px;\n        padding: 5px;\n        overflow: hidden;\n        cursor: pointer;\n\n\n        svg{\n          fill: black;\n          height: 100%;\n          width: 100%;\n          transform: rotate(-180deg);\n          transition: 0.15s ease;\n        }\n\n        &:hover svg{\n          transform: rotate(360deg);\n        }\n      }\n\n    }\n  }\n']))),K=h.ZP.div(Y||(Y=(0,d.Z)(["\n\n\nwidth: 100%;\nheight: 100%;\nposition: relative;\n\n@media (min-width: 950px){\n  padding-top: 20px;\n}\n\n&>.head{\n  display: grid;\n  grid-template-rows: 1fr;\n  align-items: space-between;\n  height: 100px;\n  position: sticky;\n  top: 0;\n  padding: 0px 20px;\n  border-radius: 0px 0px 15px 15px;\n\n\n  @media(max-width: 950px){\n    margin: 0;\n    padding-top: 20px;\n    background: var(--thm-transparent-color);\n  }\n\n  &>*{\n    @media (max-width: 950px){\n      height: 50%;\n    }\n  }\n\n\n  &>div{\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n\n    &>h3{\n      margin: 0;\n      font-size: 30px;\n\n      @media (max-width: 950px){\n        font-size: 25px;\n      }\n    }\n\n    .icon{\n      width: 20px;\n      height: 20px;\n    }\n\n    &>div{\n      display: flex;\n      align-items: center;\n      gap: 15px;\n      cursor: pointer;\n      width: 100%;\n      justify-content: flex-end;\n\n      &.searching-container{\n        width: 100%;\n      }\n\n      input{\n        border: 1px solid var(--thm-primary-color);\n        background: var(--thm-transparent-color);\n        outline: none;\n        width: 0px;\n        height: 30px;\n        opacity: 0;\n        transition: width .2s ease, opacity .5s ease;\n        border-radius: 500px;\n        padding: 0px 10px;\n        pointer-event: none;\n\n        &.searching{\n          opacity: 1;\n          width: 100%;\n          flex-grow: 1;\n          flex-shrink: 1;\n        }\n      }\n\n      &>svg{\n        flex-grow: 0;\n        flex-shrink: 0;\n      }\n    }\n  }\n\n  &>nav{\n    align-self: center;\n    @media (min-width: 951px){\n      display: none;\n    }\n  }\n\n}\n\n&>.chat-section-container{\n  padding: 0px 20px;\n  height: calc(100% - 100px);\n  overflow-y: auto;\n  overflow-x: hidden;\n  // margin-right: -20px;\n\n  @media (max-width: 950px){\n    padding-top: 10px;\n  }\n}\n"]))),O=function(){var n=(0,p.v9)((function(n){return n.chatNav})).chatSection,e=(0,l.useState)(!1),t=(0,x.Z)(e,2),r=t[0],i=t[1],a=(0,l.useState)(""),s=(0,x.Z)(a,2),o=s[0],c=s[1],d=function(){r&&c(""),i(!r)};return(0,k.jsxs)(K,{children:[(0,k.jsxs)("div",{className:"head",children:[(0,k.jsxs)("div",{children:[!r&&(0,k.jsx)("h3",{children:"recentChats"===n?"Chat":"groupChats"===n?"Groups":"Users"}),(0,k.jsxs)("div",{className:r?"searching-container":"",children:[(0,k.jsx)("input",{type:"search",className:r?"searching":"",value:o,onInput:function(n){c(n.currentTarget.value)}}),r?(0,k.jsx)(B.hT1,{onClick:d,className:"icon"}):(0,k.jsx)(V.dVI,{onClick:d,className:"icon"})]})]}),(0,k.jsx)("nav",{children:(0,k.jsx)(X,{})})]}),(0,k.jsx)("div",{className:"chat-section-container custom-scroll",children:"recentChats"===n?(0,k.jsx)(P,{search:o}):"groupChats"===n?(0,k.jsx)(L,{search:o}):(0,k.jsx)(E,{search:o})})]})},Q=t(1413),W=t(3433),G=function(n){var e=n.message,t=((0,p.v9)((function(n){return n.realTime})).chatNotifications,(0,p.v9)((function(n){return n.chat.currentChat})).Id,e.text),r=e.classes;(0,l.useRef)(null);return(0,k.jsx)(J,{children:(0,k.jsx)("div",{className:"message"+r,children:(0,k.jsx)("div",{className:"msg-text",children:2===t.length&&t[0].codePointAt(0)>8986&&t[0].codePointAt(0)<129511?(0,k.jsx)("span",{className:"only-emoji",children:t}):(0,k.jsx)(k.Fragment,{children:(0,W.Z)(t).map((function(n,e){return n.codePointAt(0)>8986&&n.codePointAt(0)<129511?(0,k.jsx)("span",{className:"txt-emoji",children:n},e):(0,k.jsx)(l.Fragment,{children:n},e)}))})})})})},J=h.ZP.section(q||(q=(0,d.Z)(["\n  .message {\n    width: 100%;\n    display: flex;\n    margin-top: 5px;\n    \n    &.left{\n      justify-content: flex-start;\n      .msg-text{\n        background: var(--thm-other-message-background);\n      }\n\n      &.start{\n        .msg-text{\n          border-bottom-left-radius: 2px;\n        }\n      }\n      &.end{\n        .msg-text{\n          border-top-left-radius: 2px;\n        }\n      }\n    }\n    \n    &.right{\n      justify-content: flex-end;\n      .msg-text{\n        background: var(--thm-own-message-background);\n      }\n\n      &.start{\n        .msg-text{\n          border-bottom-right-radius: 2px;\n        }\n      }\n      &.end{\n        .msg-text{\n          border-top-right-radius: 2px;\n        }\n      }\n    }\n\n    .msg-text{\n      max-width: 90%;\n      min-width: 50px;\n      padding: 20px 10px;\n      display: flex;\n      word-break: break-word;\n      white-space: pre-wrap;\n      // justify-content: center;\n      align-items: center;\n      // min-height: 60px;\n      border-radius: 15px;\n      background-color: var(--thm-transparent-color);\n\n      .txt-emoji{\n        font-size: 1.5em;\n        line-height: 1;\n      }\n      .only-emoji{\n        font-size: 2em;\n        line-height: 1;\n      }\n    }\n  }\n"]))),nn=l.memo(G),en=t(6856),tn=t(6036);var rn,an,sn=t.p+"static/media/welcome.3140aaa364932803e47b712789e40cf3.svg",on=h.ZP.div(rn||(rn=(0,d.Z)(["\nwidth: 100%;\nheight: 100%;\npadding: 20px;\npadding-left: 0px;\n\n@media(max-width: 850px){\n    padding-left: 20px;\n}\n\n&>div{\n    background: linear-gradient(transparent, var(--thm-transparent-color));\n    width: 100%;\n    height: 100%;\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    align-items: center;\n    border-radius: 15px;\n\n    img{\n        filter: brightness(0.5) contrast(1.5) saturate(0.7);\n        width: 100%;\n        height: 70%;\n        min-height: 200px;\n        min-width: 200px;\n        height: 60%;\n        width: 60%;\n    }\n    &>h1{\n        color: var(--thm-transparent2-color);\n    }\n"]))),cn=function(){var n=(0,p.v9)((function(n){return n.chatNav})).mobileViewSection;return(0,k.jsx)(on,{children:(0,k.jsx)("div",{children:"currentChatContainer"===n?(0,k.jsx)(M.Z,{height:"100%"}):(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)("img",{src:sn,alt:"welcome"}),(0,k.jsx)("h1",{})]})})})};function dn(){var n=(0,p.v9)((function(n){return n.chat.currentChat})).Id;(0,p.v9)((function(e){return e.realTime.chatNotifications[n]})).newMsgCount;return(0,k.jsx)(xn,{children:(0,k.jsx)("div",{className:"unreadMsgTag",children:"Unread Message"})})}var ln,hn,xn=h.ZP.div(an||(an=(0,d.Z)(["\nwidth: 100%;\ndisplay: flex;\njustify-content: center;\nalign-items: cetnter;\npadding: 20px;\ndiv{\n    padding: 5px 20px;\n    // background: var(--thm-transparent2-color);\n    border-radius: 5px;\n    box-shadow: -2px -2px 6px var(--thm-transparent2-color), 2px 2px 6px  #060910;\n}"]))),pn=t(4373),un=t(227),gn=function(){var n=(0,p.v9)((function(n){return n.chat.currentChat})),e=n.Id,t=n.messages,r=n.otherMember,i=(0,p.v9)((function(n){return n.user})).user,a=(0,p.v9)((function(n){return n.realTime})),s=a.onlineUsers,o=a.chatNotifications,c=(0,p.I0)(),d=(0,l.useRef)(null),h=(0,l.useRef)(null),m=(0,l.useRef)(null),v=(0,l.useState)(""),Z=(0,x.Z)(v,2),N=Z[0],I=Z[1],C=(0,l.useState)(!0),M=(0,x.Z)(C,2),_=M[0],P=M[1],F=function(){var n=(0,g.Z)((0,u.Z)().mark((function n(){return(0,u.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(0!==N.trim().length){n.next=3;break}return I(""),n.abrupt("return");case 3:if(window.navigator.onLine){n.next=6;break}return(0,un.X)(),n.abrupt("return");case 6:try{console.log(r.name+" is receiver name "+r._id+" is receiver id "),j.Z.emit("client-send-msg",{chatId:e,senderId:i.userId,receiverId:r._id,text:N},(function(n){if(200!=n.status)throw Error(n.error);console.log(n.data.text+" >>>> is reached to server "),c((0,f.uk)({message:(0,Q.Z)({},n.data),userId:i.userId})),c((0,w.ND)((0,Q.Z)({},n.data))),c((0,w.tk)(e)),c((0,f.gR)({chatId:e}))})),I("")}catch(t){console.log(t),c((0,w.tk)(e))}case 7:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();return(0,l.useEffect)((function(){return j.Z.on("server-send-msg",(function(n){console.log(n.senderId+" and receiver id is "+r._id),n.chatId===e?(c((0,f.uk)({message:(0,Q.Z)({},n),userId:i.userId})),c((0,w.ND)((0,Q.Z)({},n))),c((0,w.tk)(e)),j.Z.emit("message-viewed",e,n._id,(function(n){console.log("message is viewed in current message with status "+n.status)}))):c((0,w.at)((0,Q.Z)({},n))),c((0,f.gR)({chatId:n.chatId}))})),function(){j.Z.off("server-send-msg")}}),[e]),(0,l.useEffect)((function(){h.current,m.current&&m.current.scrollIntoView({behavior:"smooth"})}),[t]),(0,k.jsx)(k.Fragment,{children:""===e?(0,k.jsx)(cn,{}):(0,k.jsxs)(mn,{children:[(0,k.jsxs)("div",{className:"head",children:[(0,k.jsxs)("div",{className:"userInfo-container",children:[(0,k.jsxs)("div",{className:"back-container",onClick:function(){c((0,b.Lb)("chatBody")),c((0,f.wt)())},children:[(0,k.jsx)(pn.PjY,{}),(0,k.jsx)("div",{className:"img-container",children:(0,k.jsx)("img",{src:(0,y.Z)(r.avatar),alt:"chat user"})})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("span",{children:r.name}),s[r._id]?(0,k.jsx)("span",{children:"Online"}):null]})]}),(0,k.jsxs)("div",{className:"functionality-container",children:[(0,k.jsxs)("ul",{children:[(0,k.jsx)("li",{children:(0,k.jsx)(z.jLr,{})}),(0,k.jsx)("li",{children:(0,k.jsx)(en.ZkW,{})})]}),(0,k.jsx)("div",{className:"close-message",onClick:function(){c((0,f.h$)({name:"",Id:""})),c((0,f.wt)())},children:(0,k.jsx)(tn.OZs,{})})]})]}),(0,k.jsxs)("div",{className:"background-container",children:[(0,k.jsx)("div",{className:(_?"":"scrolling-down")+" messages custom-scroll",ref:h,onScroll:function(n){return function(n){var e=n.target.scrollTop+n.target.clientHeight>=n.target.scrollHeight;P(e)}(n)},children:t.length>0?o[e]&&o[e].lastViewedMessage&&o[e].lastViewedMessage._id!==o[e].lastMessage._id&&o[e].lastMessage.senderId!==i.userId?t.map((function(n,t){return(0,k.jsx)(l.Fragment,{children:o[e].lastViewedMessage._id===n._id?(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(nn,{message:n},t),(0,k.jsx)(dn,{})]}):(0,k.jsx)(k.Fragment,{children:o[e].lastMessage._id===n._id?(0,k.jsx)("div",{ref:m,children:(0,k.jsx)(nn,{message:n},t)}):(0,k.jsx)(nn,{message:n},t)})},t)})):t.map((function(n,t){return(0,k.jsx)(l.Fragment,{children:o[e]&&o[e].lastMessage._id===n._id?(0,k.jsx)("div",{ref:m,children:(0,k.jsx)(nn,{message:n},t)}):(0,k.jsx)(nn,{message:n},t)},t)})):(0,k.jsx)("h2",{className:"msg-404",children:"No messages found."})}),(0,k.jsxs)("div",{className:"text-editor",children:[(0,k.jsxs)("div",{className:"wrap-auto-resize",children:[(0,k.jsx)("div",{className:"textarea-cpy",children:N+" "}),(0,k.jsx)("textarea",{className:"custom-scroll",name:"message",rows:"1",placeholder:"write your message here",focus:"true",ref:d,value:N,onKeyDown:function(n){n.shiftKey||"Enter"!==n.key||(n.preventDefault(),n.repeat||F())},onChange:function(n){return I(n.target.value)},virtualkeyboardpolicy:"manual",onClick:function(){d.current.removeAttribute("virtualkeyboardpolicy")},onBlur:function(n){n.currentTarget.focus()},autoFocus:!0})]}),(0,k.jsx)("div",{children:(0,k.jsx)("button",{onClick:F,children:(0,k.jsx)(en.D6S,{})})})]})]})]})})},mn=h.ZP.section(ln||(ln=(0,d.Z)(['\n  height: 100%;\n  width: 100%;\n  padding: 20px;\n  display: flex;\n  flex-direction: column;\n\n  @media (max-width: 450px){\n    padding: 20px 10px 10px 10px;\n  }\n  \n  \n  .head {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    height: 100px;\n\n    @media ( max-width: 950px ){\n      margin-top: -20px;\n    }\n\n    .userInfo-container{\n      display: flex;\n      gap: 15px;\n      width: 100%;\n\n      .back-container{\n        display: flex;\n        align-items: center;\n\n        \n        &>svg{\n          height: 35px;\n          width: 35px;\n          \n          @media (min-width: 750px){\n            display: none;\n          }\n        }\n      }\n\n      .img-container{\n        width: 60px;\n        height: 60px;\n        background-color: yellow;\n        border-radius: 50%;\n\n        img{\n          width: 100%;\n          border-radius: 50%;\n        }\n      }\n\n      &>div:last-child{\n        display: flex;\n        flex-direction: column;\n        justify-content: center;\n        overflow: none;\n        overflow: hidden;\n\n        &>span:first-child{\n          font-weight: bold;\n          font-size: 20px;\n          text-overflow: ellipsis;\n          overflow: hidden;\n\n          &+span{\n            font-size: 10px;\n            font-style: italic;\n            color: #d5d5d5;\n          }\n        }\n      }\n    }\n\n    .functionality-container{\n      display: flex;\n      display: none;\n      gap: 40px;\n      align-items: center;\n      justify-content: space-between;\n\n      ul{\n        display: flex;\n        list-style: none;\n        gap: 20px;\n  \n        // li{\n        //   margin: 10px;\n        // }\n        svg{\n          width: 20px;\n          height: 20px;\n        }\n      }\n\n      .close-message{\n        svg{\n          width: 30px;\n          height: 30px;\n        }\n      }\n\n      svg{\n        transform: scale(1);\n        transition: 0.2s ease;\n      }\n      li, .close-message{\n        &:hover svg{\n          transform: scale(1.2);\n        }\n      }\n    }\n  }\n\n\n  .background-container{\n    background-color: var(--thm-transparent-color);\n    border-radius: 10px;\n    padding: 10px 40px;\n    height: calc(100% - 100px);\n    display: flex;\n    gap: 10px;\n    flex-direction: column;\n    overflow: hidden;  \n\n    @media (max-width: 950px){\n      height: calc(100% - 80px);\n      padding: 10px 20px;\n    }\n\n    @media (max-width: 450px){\n      padding: 10px;\n    }\n\n\n    .messages {\n      height: calc(100% - 100px);\n      flex-shrink: 1;\n      flex-grow: 1;\n      position: relative;\n      margin-right: -20px;\n\n      @media (max-width: 450px){\n        margin-right: -5px;\n      }\n\n      .msg-404{\n        height: 100%;\n        width: 100%;\n        margin: 0px;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        font-size: 30px;\n        color: var(--thm-transparent-color);\n      }\n\n\n      &.scrolling-down + .text-editor::before{\n        opacity: 1;\n      }\n    }\n\n    \n\n    .text-editor {\n      display: flex;\n      justify-content: space-between;\n      align-items: flex-end;\n      flex-shrink: 0;\n      flex-grow: 0;\n      padding: 10px 0px;\n      position: relative;\n      gap: 10px;\n\n      @media (max-width: 450px){\n        padding: 0;\n      }\n\n      //for shadow below msg container\n      &::before{\n        --height: 10px;\n        content: "";\n        display: block;\n        position: absolute;\n        top: calc(-10px - var(--height));\n        left: -50%;\n        width: 200%;\n        height: var(--height);\n        background: linear-gradient(0deg,var(--thm-background-color), transparent);\n        opacity: 0;\n        pointer-event: none;\n        transition: 0.15s ease;\n      }\n\n      \n      &>.wrap-auto-resize{\n        width: 100%;\n        min-height: 40px;\n        display: grid;\n        padding: 8px;\n        border-radius: 8px;\n        border: 1px solid var(--thm-primary-color);\n        flex-grow: 1;\n        flex-shrink: 1;\n\n        &>.textarea-cpy{\n          white-space: pre-wrap;\n          word-break: break-word;\n          visibility: hidden;\n        }\n\n        &>textarea, &>.textarea-cpy {\n          width: calc(100% + 10px);\n          min-height: 100%;\n          max-height: 6.2em;\n          margin-right: -8px; //equal to parent padding\n          border: none;\n          outline: none;\n          background-color: transparent;\n          font-size: 15px;\n          line-height: 1.25em;\n          resize: none;\n          grid-area: 1/1/2/2;\n        }\n        &>textarea::placeholder{\n          color: var(--thm-transparent2-color);\n        }\n      }\n      \n      \n      &>div:last-child{\n        display: flex;\n        flex-shrink: 0;\n        flex-grow: 0;\n        justify-content: center;\n        align-items: center;\n        \n        button {\n          width: 40px;\n          height: 40px;\n          display: flex;\n          justify-content: center;\n          align-items: center;\n          padding: 10px;\n          background-color: var(--thm-secondary-color);\n          border: none;\n          outline: none;\n          border-radius: 8px;\n\n          &>svg{\n            width: 30px;\n            height: 30px;\n          }\n        }\n      }\n    }\n  }\n  \n\n']))),fn=l.memo(gn);function vn(n){n.currentTarget.scrollTo(0,1)}var wn=function(){var n=(0,p.v9)((function(n){return n.user})).user,e=(0,p.v9)((function(n){return n.chatNav})).mobileViewSection,t=(0,p.I0)();return(0,l.useEffect)((function(){function e(){j.Z.emit("register-connection",{userId:n.userId,socketId:j.Z.id},(function(n){console.log(n),t((0,w.Rx)(n.onlineUsers))}))}return j.Z.connected?e():j.Z.on("connect",(function(){e()})),j.Z.on("new-user-connected",(function(n){t((0,w.ai)(n))})),j.Z.on("user-disconnected",(function(n){t((0,w.WZ)(n))})),function(){j.Z.off("connect"),j.Z.off("register-connection"),j.Z.off("new-user-connected"),j.Z.off("user-disconnected")}}),[]),(0,l.useEffect)((function(){window.scrollTo(0,1)})),(0,k.jsx)(k.Fragment,{children:(0,k.jsx)(jn,{onLoad:vn,children:(0,k.jsxs)("div",{className:("currentChatContainer"===e?"show-current-message-container ":"")+"container",children:[(0,k.jsx)("nav",{children:(0,k.jsx)(X,{})}),(0,k.jsx)("div",{className:"chat-container",children:(0,k.jsx)(O,{})}),(0,k.jsx)("div",{className:"current-chat-container",children:(0,k.jsx)(fn,{})})]})})})},jn=h.ZP.section(hn||(hn=(0,d.Z)(["\n --thm-svg-color: #9e9e9e;\n --thm-svg-active-color: var(--thm-primary-color); \n\n  width: 100vw;\n  height: 100vh;\n  height: var(--calculated-vh, 100vh);\n  overflow: hidden;\n  position: relative;\n\n  &:fullscreen, &::backdrop{\n    background-color: var(--thm-background-color);\n  }\n\n  *{\n    color: white;\n  }\n\n  .container {\n    display: flex;\n    height: 100%;\n    width: 100%;\n    transition: 0.2s ease;\n\n    @media (max-width: 950px){\n      overflow: hidden;\n      display: grid;\n      grid-template-columns: 0.75fr 1fr;\n      grid-auto-rows: 100%;\n    }\n    @media (max-width: 750px){\n      position: absolute;\n      top: 0;\n      left: 0;\n      grid-template-columns: 1fr 1fr;\n      width: 200%;\n    }\n\n    &.show-current-message-container{\n      @media( max-width: 750px){\n        left: -100%;\n      }\n    }\n\n    &>nav{\n      height: 100%;\n      @media (max-width: 950px){\n        display: none;\n      }\n    }\n\n    .chat-container {\n      flex-basis: 400px;\n      width: 400px;\n      min-width: 350px;\n      height: 100%;\n      overflow-y: auto;\n      overflow-x: hidden;\n\n      @media (max-width: 950px){\n        width: 100%;\n        grid-area: 1/1/2/2;\n      }\n    }\n\n    .current-chat-container {\n      width: calc(100% - 80px - 400px);\n      min-width: 350px;\n      height: 100%;\n\n      @media (max-width: 950px){\n        width: 100%;\n        grid-area: 1/2/2/3;\n      }\n    }\n  }\n"]))),bn=l.memo(wn)}}]);
//# sourceMappingURL=123.3fb5b35b.chunk.js.map