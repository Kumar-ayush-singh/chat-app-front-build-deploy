"use strict";(self.webpackChunkchat=self.webpackChunkchat||[]).push([[689],{2689:function(n,e,t){t.r(e),t.d(e,{default:function(){return Mn}});var r,i=t(168),a=t(2791),s=t(6444),o=t(9439),c=t(9434),d=t(4165),l=t(5861),h=t(1912),p=t(8077),x=s.ZP.section(r||(r=(0,i.Z)(["\n\n  --thm-online-status-color: var(--thm-primary-color);\n  --thm-selected-chat-color: linear-gradient(300deg, var(--thm-primary-color), var(--thm-secondary-color));\n\n  margin-bottom: 5px;\n  @media (max-width: 950px){\n    margin: 0;\n  }\n\n  .card {\n    display: flex;\n    align-items: center;\n    gap: 10px;\n    background-color: var(--thm-transparent-color);\n    border-radius: 15px;\n    padding: 15px 20px;\n    // box-shadow: 0px 0px 2px var(--thm-background-color) inset;\n    // position: relative;\n\n    @media(max-width: 950px){\n      background-color: transparent;\n      padding: 10px;\n    }\n\n    &:hover{\n      background: var(--thm-transparent2-color);\n    }\n    &.active{\n      @media (min-width: 750px){\n        background: var(--thm-selected-chat-color);\n      }\n    }\n\n    &>div.img-notification-container {\n      height: max-content;\n      width: max-content;\n      position: relative;\n\n      img{\n        width: 50px;\n        height: 50px;\n        width: 50px;\n        border-radius: 50%;\n      }\n\n      div{\n        position: absolute;\n        top: 0;\n        right: 0;\n        width: 20px;\n        height: 20px;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        border-radius: 50%;\n        color: black;\n        font-weight: bold;\n        background: yellow;\n      }\n    }\n\n    &>div.card-info{\n      flex-grow: 1;\n      display: flex;\n      flex-direction: column;\n      gap: 4px;\n      overflow: hidden;\n\n      h5{\n        margin: 0;\n        text-overflow: ellipsis;\n        overflow: hidden;\n        white-space: nowrap;\n      }\n      &>div{\n        display: flex;\n        justify-content: flex-start;\n        align-items: center;\n        gap: 5px;\n      }\n\n      span{\n        font-size: 12px;\n        color: #d5d5d5;\n        overflow: hidden;\n        text-overflow: ellipsis;\n        white-space: nowrap;\n        font-weight: 500;\n      }\n\n      &.new-message{\n        font-weight: bold;\n      }\n    }\n\n    &>span, div.img-notification-container{\n      display: block;\n      flex-shrink: 0;\n      flex-grow: 0;\n      font-size: 12px;\n      color: #d5d5d5;\n      font-weight: 500;\n    }\n    \n    span.online{\n      width: 12px;\n      height: 12px;\n      flex-shrink: 0;\n      flex-grow: 0;\n      border-radius: 50%;\n\n      background: var(--thm-online-status-color);\n    }\n  }\n"]))),u=t(6118),g=t(8772),m=t(6247),f=t(7215);function v(n){var e=n.getHours(),t=n.getMinutes(),r=e>=12?"pm":"am";return(e=(e%=12)||12)+":"+(t=t<10?"0"+t:t)+" "+r}var w=["January","February","March","April","May","June","July","August","September","November","December"];function j(n,e){var t=new Date;if(t.getDate()===n.getDate())return"Today";if(t.getDate()-n.getDate()===1)return"Yeasterday";var r=n.getDate(),i=n.getMonth(),a=n.getFullYear()-2e3;return e?"".concat(w[i]," ").concat(r,", ").concat(a):"".concat(r,"/").concat(i+1,"/").concat(a)}var b,y,k,Z,N,I=t(184),C=function(n){var e=(0,c.I0)(),t=(0,c.v9)((function(n){return n.user})).user,r=(0,c.v9)((function(n){return n.chat})).currentChat,i=(0,c.v9)((function(n){return n.realTime})),s=i.onlineUsers,o=i.chatNotifications,d=n.chat._id===r.Id;(0,a.useEffect)((function(){e((0,u.at)({chatId:n.chat._id,lastMessage:n.chat.lastMessage||{},newMsgCount:n.chat.lastMessage&&n.chat.lastMessage.senderId!==t.userId?n.chat.unreadMsgCount:0,lastViewedMessage:n.chat.lastViewedMessage||{},dataFromDB:!0}))}),[n.chat]),console.log(n.chat);var l=o[n.chat._id]?o[n.chat._id].lastMessage.createdAt?o[n.chat._id].lastMessage.createdAt:n.chat.createdAt:null;return(0,I.jsx)(x,{children:(0,I.jsxs)("div",{className:(d?"active":"")+" card",onClick:function(){d||(e((0,p.wt)()),o[r.Id]&&e((0,u.zF)(r.Id)),e((0,p.h$)({name:n.chat.otherMember.name,Id:n.chat.otherMember._id,avatar:n.chat.otherMember.avatar})),e((0,p.YQ)({chatId:n.chat._id,userId:t.userId})),e((0,m.Lb)("currentChatContainer")),o[n.chat._id]&&o[n.chat._id].newMsgCount&&g.Z.emit("message-viewed",n.chat._id,{_id:o[n.chat._id].lastMessage._id,senderId:o[n.chat._id].lastMessage.senderId},(function(n){console.log("Viewed message id is send to server and get response status ".concat(n.status))})))},children:[(0,I.jsxs)("div",{className:"img-notification-container",children:[(0,I.jsx)("img",{src:(0,f.Z)(n.chat.otherMember.avatar),alt:""}),!d&&o[n.chat._id]&&o[n.chat._id].newMsgCount>=1?(0,I.jsx)("div",{children:o[n.chat._id].newMsgCount}):null]}),(0,I.jsxs)("div",{className:"card-info new-message",children:[(0,I.jsxs)("div",{children:[(0,I.jsx)("h5",{children:n.chat.otherMember.name}),(0,I.jsx)("span",{className:s[n.chat.otherMember._id]?"online":"offline"})]}),o[n.chat._id]&&o[n.chat._id].lastMessage.text?(0,I.jsxs)("span",{className:"last-msg-txt",children:[o[n.chat._id].lastMessage.senderId===t.userId?"You: ":null,o[n.chat._id].lastMessage.text]}):null]}),(0,I.jsx)("span",{className:"date",children:j(new Date(l))})]})})},M=t(6719),_=t(9341),D=t(5033),z=t(8610),A=s.ZP.div(b||(b=(0,i.Z)(["\nheight: 100%;\n\n    .chat404{\n        width: 100%;\n        height: 100%;\n        display: flex;\n        justify-content: center;\n        align-items: center;\n        padding: 30px;\n        border-radius: 15px;\n        background: linear-gradient(var(--thm-transparent-color), transparent);\n        font-weight: 500;\n\n\n        &>div.no-chat{\n            width: 100%;\n            padding: 20px;\n            margin-top: -50px;\n            text-align: center;\n            background: var(--thm-transparent-color);\n            border-radius: 10px;\n            \n            button{\n                margin-top: 15px;\n                background: var(--thm-gradient);\n                outline: none;\n                border: none;\n                border-radius: 5px;\n                padding: 10px 20px;\n                cursor: pointer;\n                font-weight: inherit;\n            }\n        }\n    }\n"]))),F=function(n){var e=n.search,t=(0,c.I0)(),r=(0,c.v9)((function(n){return n.user})).user,i=(0,a.useState)(!0),s=(0,o.Z)(i,2),x=s[0],u=s[1],g=(0,c.v9)((function(n){return n.chat})),f=g.allChats,v=g.newChat,w=function(){var n=(0,l.Z)((0,d.Z)().mark((function n(){var e,i,a;return(0,d.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,e=(0,M.LP)()){n.next=5;break}return t(_.ne),n.abrupt("return");case 5:return n.next=7,h.Z.get("".concat(D.L,"/api/chat/").concat(r.userId),{headers:{Authorization:"Bearer ".concat(e)}});case 7:i=n.sent,a=i.data,u(!1),t((0,p.uE)(a)),console.log("All Chats of user : "),console.log(a),n.next=17;break;case 15:n.prev=15,n.t0=n.catch(0);case 17:case"end":return n.stop()}}),n,null,[[0,15]])})));return function(){return n.apply(this,arguments)}}();(0,a.useEffect)((function(){w()}),[v]);return(0,I.jsx)(I.Fragment,{children:(0,I.jsx)(A,{children:0===f.length?(0,I.jsx)("div",{className:"chat404",children:x?(0,I.jsx)(z.Z,{height:"100%"}):(0,I.jsxs)("div",{className:"no-chat",children:[(0,I.jsx)("div",{children:"No Chat Available."}),(0,I.jsx)("button",{onClick:function(){t((0,m.XU)("searchUsers"))},children:"Start New"})]})}):f.map((function(n,t){return String(n.otherMember.name).toLowerCase().includes(e.toLowerCase())?(0,I.jsx)(C,{chat:n},t):null}))})})},P=t(6355),S=s.ZP.section(y||(y=(0,i.Z)(["\n  .chat-card {\n    display: flex;\n    align-items: center;\n    gap: 2rem;\n    border-radius: 20px 20px;\n    margin: 5px 1rem;\n    background-color: white;\n    padding: 0.5rem;\n    .icon {\n      font-size: 2rem;\n    }\n  }\n"]))),T=function(){return(0,I.jsx)(S,{children:(0,I.jsxs)("div",{className:"chat-card",children:[(0,I.jsx)("div",{className:"icon",children:(0,I.jsx)(P.qc7,{})}),(0,I.jsx)("h5",{children:"group name"})]})})},L=s.ZP.section(k||(k=(0,i.Z)(["\n\n"]))),U=function(){return(0,I.jsx)(L,{children:(0,I.jsx)(T,{})})},E=function(n){var e=n.name,t=n.Id,r=n.avatar,i=(0,c.I0)(),a=(0,c.v9)((function(n){return n.user})).user,s=(0,c.v9)((function(n){return n.realTime})),o=s.onlineUsers,g=s.chatNotifications,v=(0,c.v9)((function(n){return n.chat})).currentChat,w=function(){var n=(0,l.Z)((0,d.Z)().mark((function n(){var s,o,c;return(0,d.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,(s=(0,M.LP)())||i((0,_.ne)()),console.log(a),n.next=6,h.Z.post("".concat(D.L,"/api/chat"),{senderId:a.userId,receiverId:t},{headers:{Authorization:"Bearer ".concat(s)}});case 6:o=n.sent,c=o.data,i((0,p.YQ)({chatId:c._id,userId:a.userId})),i((0,u.at)({chatId:c._id,dataFromDB:!0,newMsgCount:0,lastMessage:{},lastViewedMessage:{}})),i((0,m.XU)("recentChats")),i((0,p.h$)({name:e,Id:t,avatar:r})),i((0,m.Lb)("currentChatContainer")),g[v.Id]&&0===g[v.Id].newMsgCount&&i((0,u.zF)(v.Id)),n.next=19;break;case 16:n.prev=16,n.t0=n.catch(0),console.log(n.t0);case 19:case"end":return n.stop()}}),n,null,[[0,16]])})));return function(){return n.apply(this,arguments)}}();return(0,I.jsx)(x,{children:(0,I.jsxs)("div",{className:"card",onClick:w,children:[(0,I.jsx)("div",{className:"img-notification-container",children:(0,I.jsx)("img",{src:(0,f.Z)(r),alt:""})}),(0,I.jsx)("div",{className:"card-info",children:(0,I.jsx)("h5",{children:e})}),(0,I.jsx)("span",{className:o[t]?"online":"offline"})]})})},B=s.ZP.section(Z||(Z=(0,i.Z)(["\n  height: 100%;\n  .user404{\n    width: 100%;\n    height: 100%;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    padding: 30px;\n    border-radius: 15px;\n    background: linear-gradient(var(--thm-transparent-color), transparent);\n    font-weight: 500;\n  }\n"]))),V=function(n){var e=n.search,t=(0,c.v9)((function(n){return n.user})).user,r=(0,c.v9)((function(n){return n.chat})).allUsers,i=(0,a.useState)(!0),s=(0,o.Z)(i,2),x=s[0],u=s[1],g=(0,c.I0)(),m=function(){var n=(0,l.Z)((0,d.Z)().mark((function n(){var e,t,r;return(0,d.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e=(0,M.LP)()){n.next=4;break}return g((0,_.ne)()),n.abrupt("return");case 4:return n.next=6,h.Z.get("".concat(D.L,"/api/user/get-all/"),{headers:{Authorization:"Bearer ".concat(e)}});case 6:t=n.sent,r=t.data,g((0,p.BA)(r)),u(!1),console.log("All users : "),console.log(r);case 12:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();return(0,a.useEffect)((function(){m()}),[]),(0,I.jsx)(B,{children:x&&!r.length?(0,I.jsx)("div",{className:"user404",children:(0,I.jsx)(z.Z,{height:"100%"})}):(0,I.jsx)(I.Fragment,{children:r.map((function(n,r){var i=n.name,a=n._id,s=n.avatar;return a===t.userId?null:String(i).toLowerCase().includes(e.toLowerCase())?(0,I.jsx)(E,{name:i,Id:a,avatar:s},r):null}))})})},Y=t(9126),R=t(3853),$=t(7689),H=t(1087),X=t(7692);function q(){var n=(0,c.v9)((function(n){return n.chatNav})).chatSection,e=(0,c.I0)(),t=(0,$.s0)();function r(n){e((0,m.XU)(n))}return(0,I.jsxs)(O,{className:"chatNavBar",children:[(0,I.jsxs)("ul",{children:[(0,I.jsx)("li",{className:"groupChats"===n?"active":"",onClick:function(){r("groupChats")},children:(0,I.jsx)(X.p$$,{})}),(0,I.jsx)("li",{className:"recentChats"===n?"active":"",onClick:function(){r("recentChats")},children:(0,I.jsx)(Y.i0Y,{})}),(0,I.jsx)("li",{className:"searchUsers"===n?"active":"",onClick:function(){r("searchUsers")},children:(0,I.jsx)(X.EDj,{})})]}),(0,I.jsxs)("div",{className:"high-order-buttons",children:[(0,I.jsx)("button",{className:"home",children:(0,I.jsx)(H.rU,{to:"/",children:(0,I.jsx)(P.xng,{})})}),(0,I.jsx)("button",{className:"log-out",onClick:function(){e((0,_.ne)()),t("/")},children:(0,I.jsx)(H.rU,{to:"/",children:(0,I.jsx)(X.TPb,{})})})]})]})}var J,K,O=s.ZP.nav(N||(N=(0,i.Z)(['\n\n&.chatNavBar {\n    --container-width: 80px;\n    width: var(--container-width);\n    height: 100%;\n    display: flex;\n    align-items: center;\n    position: relative;\n\n    @media (max-width: 950px){\n        width: 100%;\n    }\n\n    ul {\n      display: flex;\n      flex-direction: column;\n      width: 100%;\n\n      @media (max-width: 950px){\n        flex-direction: row;\n        justify-content: space-between;\n      }\n\n      li{\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        padding: 10px 20px;\n        margin: 10px 0px;\n        cursor: pointer;\n        position: relative;\n\n        @media (max-width: 950px){\n            margin: 0px;\n            padding: 10px;\n        }\n\n        &, *{\n          transition: 0.2s ease;\n        }\n\n        svg{\n          width: var(--container-width);\n          height: 25px;\n          transform: scale(1);\n          transform-origin: center center;\n        }\n\n        &.active, &:hover{\n          svg{\n            transform: scale(1.2);\n          }\n        }\n        \n        &.active{\n          @media (max-width: 950px){\n            margin-top: -15px;\n          }\n\n          svg{\n            fill: var(--thm-svg-active-color);\n          }\n\n          &::after{\n            top: 0;\n            height: 100%;\n\n            @media(max-width: 950px){\n                height: 3px;\n                left: 0;\n                top: unset;\n                width: 100%;\n            }\n          }\n\n        }\n        &::after{\n          content: "";\n          position: absolute;\n          display: block;\n          background: var(--thm-svg-active-color);\n          top: 50%;\n          left: 0px;\n          width: 5px;\n          border-radius: 3px;\n          height: 0px;\n          transition: 0.2s linear;\n\n\n          @media (max-width: 950px){\n            top: unset;\n            bottom: 0px;\n            left: 50%;\n            height: 3px;\n            width: 0px;\n          }\n        }\n      }\n    }\n\n    .high-order-buttons{\n      position: absolute;\n      bottom: 0px;\n      left: 0px;\n      width: var(--container-width);\n      padding: 8px;\n\n      @media (max-width: 950px){\n        display: none;\n      }\n\n\n      .home{\n        width: 100%;\n        height: 40px;\n        padding: 5px;\n        margin-bottom: 5px;\n        background: transparent;\n        border: none;\n        outline: none;\n\n        svg{\n          height: 100%;\n          width: 100%;\n          cursor: pointer;\n        }\n      }\n\n      .log-out{\n        height: 40px;\n        width: 100%;\n        background: #fbd547;\n        border-radius: 5px;\n        padding: 5px;\n        overflow: hidden;\n        cursor: pointer;\n\n\n        svg{\n          fill: black;\n          height: 100%;\n          width: 100%;\n          transform: rotate(-180deg);\n          transition: 0.15s ease;\n        }\n\n        &:hover svg{\n          transform: rotate(360deg);\n        }\n      }\n\n    }\n  }\n']))),Q=s.ZP.div(J||(J=(0,i.Z)(["\n\n\nwidth: 100%;\nheight: 100%;\nposition: relative;\n\n@media (min-width: 950px){\n  padding-top: 20px;\n}\n\n&>.head{\n  display: grid;\n  grid-template-rows: 1fr;\n  align-items: space-between;\n  height: 100px;\n  position: sticky;\n  top: 0;\n  padding: 0px 20px;\n  border-radius: 0px 0px 15px 15px;\n\n\n  @media(max-width: 950px){\n    margin: 0;\n    padding-top: 20px;\n    background: var(--thm-transparent-color);\n  }\n\n  &>*{\n    @media (max-width: 950px){\n      height: 50%;\n    }\n  }\n\n\n  &>div{\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n\n    &>h3{\n      margin: 0;\n      font-size: 30px;\n\n      @media (max-width: 950px){\n        font-size: 25px;\n      }\n    }\n\n    .icon{\n      width: 20px;\n      height: 20px;\n    }\n\n    &>div{\n      display: flex;\n      align-items: center;\n      gap: 15px;\n      width: 100%;\n      justify-content: flex-end;\n\n      &.searching-container{\n        width: 100%;\n      }\n\n      input{\n        border: 1px solid var(--thm-primary-color);\n        background: var(--thm-transparent-color);\n        outline: none;\n        width: 0px;\n        height: 30px;\n        opacity: 0;\n        transition: width .2s ease, opacity .5s ease;\n        border-radius: 500px;\n        padding: 0px 10px;\n        pointer-event: none;\n\n        &.searching{\n          opacity: 1;\n          width: 100%;\n          flex-grow: 1;\n          flex-shrink: 1;\n        }\n      }\n\n      &>svg{\n        flex-grow: 0;\n        cursor: pointer;\n        flex-shrink: 0;\n      }\n    }\n  }\n\n  &>nav{\n    align-self: center;\n    @media (min-width: 951px){\n      display: none;\n    }\n  }\n\n}\n\n&>.chat-section-container{\n  padding: 0px 20px;\n  height: calc(100% - 100px);\n  overflow-y: auto;\n  overflow-x: hidden;\n  // margin-right: -20px;\n\n  @media (max-width: 950px){\n    padding-top: 10px;\n  }\n}\n"]))),W=function(){var n=(0,c.v9)((function(n){return n.chatNav})).chatSection,e=(0,a.useState)(!1),t=(0,o.Z)(e,2),r=t[0],i=t[1],s=(0,a.useState)(""),d=(0,o.Z)(s,2),l=d[0],h=d[1],p=function(){r&&h(""),i(!r)};return(0,I.jsxs)(Q,{children:[(0,I.jsxs)("div",{className:"head",children:[(0,I.jsxs)("div",{children:[!r&&(0,I.jsx)("h3",{children:"recentChats"===n?"Chat":"groupChats"===n?"Groups":"Users"}),(0,I.jsxs)("div",{className:r?"searching-container":"",children:[(0,I.jsx)("input",{type:"search",className:r?"searching":"",value:l,onInput:function(n){h(n.currentTarget.value)}}),r?(0,I.jsx)(R.hT1,{onClick:p,className:"icon"}):(0,I.jsx)(Y.dVI,{onClick:p,className:"icon"})]})]}),(0,I.jsx)("nav",{children:(0,I.jsx)(q,{})})]}),(0,I.jsx)("div",{className:"chat-section-container custom-scroll",children:"recentChats"===n?(0,I.jsx)(F,{search:l}):"groupChats"===n?(0,I.jsx)(U,{search:l}):(0,I.jsx)(V,{search:l})})]})},G=t(1413),nn=t(3433),en=t(6856),tn=t(4651),rn=function(n){var e=n.message,t=n.viewed;n.reached;var r=(0,c.v9)((function(n){return n.realTime})),i=(r.chatNotifications,r.onlineUsers),s=(0,c.v9)((function(n){return n.chat.currentChat})),o=(s.Id,s.otherMember),d=e.text,l=e.classes,h=new Date(e.createdAt);return(0,I.jsx)(an,{children:(0,I.jsx)("div",{className:"message"+l,children:(0,I.jsxs)("div",{className:"msg-text-container",children:[(0,I.jsxs)("div",{className:"msg-text",children:[2===d.length&&d[0].codePointAt(0)>8986&&d[0].codePointAt(0)<129511?(0,I.jsx)("span",{className:"only-emoji",children:d}):(0,I.jsx)(I.Fragment,{children:(0,nn.Z)(d).map((function(n,e){return n.codePointAt(0)>8986&&n.codePointAt(0)<129511?(0,I.jsx)("span",{className:"txt-emoji",children:n},e):(0,I.jsx)(a.Fragment,{children:n},e)}))}),(0,I.jsx)("span",{className:"white-space"})]}),(0,I.jsxs)("div",{className:"msg-time",children:[v(h),(0,I.jsx)("span",{className:"".concat(t?"viewed":""," msg-status"),children:t||i[o._id]?(0,I.jsx)(tn.Slv,{}):(0,I.jsx)(tn.Lrl,{})})]})]})})})},an=s.ZP.section(K||(K=(0,i.Z)(["\n  .message {\n    width: 100%;\n    display: flex;\n    margin-top: 5px;\n    \n    &.left{\n      justify-content: flex-start;\n      .white-space{\n        display: inline-block;\n        width: 65px;\n      }\n\n      .msg-text-container{\n        background: var(--thm-other-message-background);\n      }\n\n      &.start{\n        .msg-text-container{\n          border-bottom-left-radius: 2px;\n        }\n      }\n      &.end{\n        .msg-text-container{\n          border-top-left-radius: 2px;\n        }\n      }\n\n      .msg-status{\n        display: none !important;\n      }\n    }\n    \n    &.right{\n      justify-content: flex-end;\n\n      .white-space{\n        display: inline-block;\n        width: 80px;\n      }\n\n      .msg-text-container{\n        background: var(--thm-own-message-background);\n      }\n\n      &.start{\n        .msg-text-container{\n          border-bottom-right-radius: 2px;\n        }\n      }\n      &.end{\n        .msg-text-container{\n          border-top-right-radius: 2px;\n        }\n      }\n    }\n\n    .msg-text-container{\n      border-radius: 15px;\n      position: relative;\n      max-width: 90%;\n      background-color: var(--thm-transparent-color);\n\n      .msg-text{\n        min-width: 50px;\n        padding: 15px 10px 15px 10px;\n        display: flex;\n        word-break: break-word;\n        white-space: pre-wrap;\n        // justify-content: center;\n        align-items: center;\n        // min-height: 60px;\n\n        \n      }\n\n      .txt-emoji{\n        font-size: 1.5em;\n        line-height: 1;\n      }\n      .only-emoji{\n        font-size: 2em;\n        line-height: 1;\n      }\n\n      .msg-time{\n        --time-color: #bfbfbf;\n        position: absolute;\n        bottom: 0;\n        right: 0;\n        font-size: 12px;\n        padding: 5px;\n        color: var(--time-color);\n        display: flex;\n        align-items: center;\n        gap: 5px;\n\n        span{\n          display: flex;\n        }\n        svg{\n          fill: white;\n          width: 1.2em;\n          height: 1.2em;\n        }\n\n        &>.viewed{\n          svg{\n            fill: #00ffb1;\n          }\n        }\n      }\n    }\n  }\n"]))),sn=a.memo(rn),on=t(6036);var cn,dn,ln=t.p+"static/media/welcome.3140aaa364932803e47b712789e40cf3.svg",hn=s.ZP.div(cn||(cn=(0,i.Z)(["\nwidth: 100%;\nheight: 100%;\npadding: 20px;\npadding-left: 0px;\n\n@media(max-width: 850px){\n    padding-left: 20px;\n}\n\n&>div{\n    background: linear-gradient(transparent, var(--thm-transparent-color));\n    width: 100%;\n    height: 100%;\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    align-items: center;\n    border-radius: 15px;\n\n    img{\n        filter: brightness(0.5) contrast(1.5) saturate(0.7);\n        width: 100%;\n        height: 70%;\n        min-height: 200px;\n        min-width: 200px;\n        height: 60%;\n        width: 60%;\n    }\n    &>h1{\n        color: var(--thm-transparent2-color);\n    }\n"]))),pn=function(){var n=(0,c.v9)((function(n){return n.chatNav})).mobileViewSection;return(0,I.jsx)(hn,{children:(0,I.jsx)("div",{children:"currentChatContainer"===n?(0,I.jsx)(z.Z,{height:"100%"}):(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)("img",{src:ln,alt:"welcome"}),(0,I.jsx)("h1",{})]})})})};function xn(){var n=(0,c.v9)((function(n){return n.chat.currentChat})).Id;(0,c.v9)((function(e){return e.realTime.chatNotifications[n]})).newMsgCount;return(0,I.jsx)(gn,{children:(0,I.jsx)("div",{className:"unreadMsgTag",children:"Unread Message"})})}var un,gn=s.ZP.div(dn||(dn=(0,i.Z)(["\nwidth: 100%;\ndisplay: flex;\njustify-content: center;\nalign-items: cetnter;\npadding: 20px;\ndiv{\n    padding: 5px 20px;\n    // background: var(--thm-transparent2-color);\n    border-radius: 5px;\n    box-shadow: -2px -2px 6px var(--thm-transparent2-color), 2px 2px 6px  #060910;\n}"]))),mn=t(4373),fn=t(227);function vn(n){var e=n.date,t=n.topDate,r=new Date(e);return(0,I.jsx)(bn,{topDate:t,display:"notDisplay"!==e,children:(0,I.jsx)("div",{className:"msgDate",children:(0,I.jsx)("div",{children:t?e:j(r,!0)})})})}var wn,jn,bn=s.ZP.section(un||(un=(0,i.Z)(["\nwidth: 100%;\ndisplay: flex;\njustify-content: center;\nalign-items: center;\nmargin-top: 5px;\nposition: ",";\nz-index: ",";\ndisplay: ",";\n\ntop: 0px;\n\n\n&>.msgDate{\n    background: var(--thm-background-color);\n    border-radius: 5px;\n\n    &>div{\n        padding: 5px;\n        border-radius: 5px;\n        font-size: 13px;\n        background: var(--thm-transparent2-color);\n    }\n}\n"])),(function(n){return n.topDate?"sticky":"initial"}),(function(n){return n.topDate?"5":"initial"}),(function(n){return n.display?"flex":"none"})),yn=function(){var n=(0,c.v9)((function(n){return n.chat.currentChat})),e=n.Id,t=n.messages,r=n.otherMember,i=(0,c.v9)((function(n){return n.user})).user,s=(0,c.v9)((function(n){return n.realTime})),h=s.onlineUsers,x=s.chatNotifications,v=(0,c.I0)(),w=(0,a.useRef)(null),j=(0,a.useRef)(null),b=(0,a.useRef)(null),y=(0,a.useState)(""),k=(0,o.Z)(y,2),Z=k[0],N=k[1],C=(0,a.useState)(""),M=(0,o.Z)(C,2),_=M[0],D=M[1],z=(0,a.useState)(!0),A=(0,o.Z)(z,2),F=A[0],S=A[1],T=function(){var n=(0,l.Z)((0,d.Z)().mark((function n(){return(0,d.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(0!==_.trim().length){n.next=3;break}return D(""),n.abrupt("return");case 3:if(window.navigator.onLine){n.next=6;break}return(0,fn.X)(),n.abrupt("return");case 6:try{console.log(r.name+" is receiver name "+r._id+" is receiver id "),g.Z.emit("client-send-msg",{chatId:e,senderId:i.userId,receiverId:r._id,text:_},(function(n){if(200!=n.status)throw Error(n.error);console.log(n.data.text+" >>>> is reached to server "),v((0,p.uk)({message:(0,G.Z)({},n.data),userId:i.userId})),v((0,u.ND)((0,G.Z)({},n.data))),v((0,u.zF)(e)),v((0,p.gR)({chatId:e}))})),D("")}catch(t){console.log(t),v((0,u.zF)(e))}case 7:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();function L(){for(var n=document.querySelectorAll(".msgDate"),e=n.length-1;e>=0;e--)if(j.current.scrollTop>=n[e].offsetTop){N(n[e].innerText),e===n.length-1&&N("notDisplay"),0===e&&N("notDisplay");break}}(0,a.useEffect)((function(){return g.Z.on("server-send-msg",(function(n){console.log(n.senderId+" and receiver id is "+r._id),n.chatId===e?(v((0,p.uk)({message:(0,G.Z)({},n),userId:i.userId})),v((0,u.ND)((0,G.Z)({},n))),v((0,u.zF)(e)),g.Z.emit("message-viewed",e,{_id:n._id,senderId:n.senderId},(function(n){console.log("message is viewed in current message with status "+n.status)}))):v((0,u.at)((0,G.Z)({},n))),v((0,p.gR)({chatId:n.chatId}))})),g.Z.on("message-viewed-by-receiver",(function(n){console.error("message is viewed by receiver "+n),v((0,u.tk)({chatId:e,msgId:n}))})),function(){g.Z.off("server-send-msg"),g.Z.off("message-viewed-by-receiver")}}),[e]),(0,a.useEffect)((function(){j.current&&j.current.scrollTo(0,j.current.scrollHeight),b.current&&(b.current.scrollIntoView({behavior:"smooth"}),L())}),[t]);var U,E=!1;return(0,I.jsx)(I.Fragment,{children:""===e?(0,I.jsx)(pn,{}):(0,I.jsxs)(kn,{children:[(0,I.jsxs)("div",{className:"head",children:[(0,I.jsxs)("div",{className:"userInfo-container",children:[(0,I.jsxs)("div",{className:"back-container",onClick:function(){v((0,m.Lb)("chatBody")),v((0,p.wt)()),v((0,u.zF)(e))},children:[(0,I.jsx)(mn.PjY,{}),(0,I.jsx)("div",{className:"img-container",children:(0,I.jsx)("img",{src:(0,f.Z)(r.avatar),alt:"chat user"})})]}),(0,I.jsxs)("div",{children:[(0,I.jsx)("span",{children:r.name}),h[r._id]?(0,I.jsx)("span",{children:"Online"}):null]})]}),(0,I.jsxs)("div",{className:"functionality-container",children:[(0,I.jsxs)("ul",{children:[(0,I.jsx)("li",{children:(0,I.jsx)(P.jLr,{})}),(0,I.jsx)("li",{children:(0,I.jsx)(en.ZkW,{})})]}),(0,I.jsx)("div",{className:"close-message",onClick:function(){v((0,p.h$)({name:"",Id:""})),v((0,p.wt)())},children:(0,I.jsx)(on.OZs,{})})]})]}),(0,I.jsxs)("div",{className:"background-container",children:[(0,I.jsx)("div",{className:(F?"":"scrolling-down")+" messages custom-scroll",ref:j,onScroll:function(n){return function(n){var e=n.target.scrollTop+n.target.clientHeight>=n.target.scrollHeight;S(e),L()}(n)},children:t.length>0?(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(vn,{topDate:!0,date:Z}),t.map((function(n,t){var r=(0,I.jsxs)(a.Fragment,{children:[new Date(n.createdAt).getDate()!==U?(0,I.jsx)(vn,{className:"msgDate",date:n.createdAt}):null,x[e]&&x[e].newMsgCount&&x[e].lastViewedMessage._id===n._id?(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(sn,{message:n,viewed:!E},t),(0,I.jsx)(xn,{})]}):(0,I.jsx)(I.Fragment,{children:x[e].lastMessage._id===n._id?(0,I.jsx)("div",{ref:b,children:(0,I.jsx)(sn,{message:n,viewed:!E},t)}):(0,I.jsx)(sn,{message:n,viewed:!E},t)})]},t);return E=!(E||!x[e]||x[e].lastViewedMessage._id!==n._id)||E,U=U!==n.createdAt?new Date(n.createdAt).getDate():U,r}))]}):(0,I.jsx)("h2",{className:"msg-404",children:"No messages found."})}),(0,I.jsxs)("div",{className:"text-editor",children:[(0,I.jsxs)("div",{className:"wrap-auto-resize",children:[(0,I.jsx)("div",{className:"textarea-cpy",children:_+" "}),(0,I.jsx)("textarea",{className:"custom-scroll",name:"message",rows:"1",placeholder:"write your message here",focus:"true",ref:w,value:_,onKeyDown:function(n){n.shiftKey||"Enter"!==n.key||(n.preventDefault(),n.repeat||T())},onChange:function(n){return D(n.target.value)},virtualkeyboardpolicy:"manual",onClick:function(){w.current.removeAttribute("virtualkeyboardpolicy")},onBlur:function(n){n.currentTarget.focus()},autoFocus:!0})]}),(0,I.jsx)("div",{children:(0,I.jsx)("button",{onClick:T,children:(0,I.jsx)(en.D6S,{})})})]})]})]})})},kn=s.ZP.section(wn||(wn=(0,i.Z)(['\n  height: 100%;\n  width: 100%;\n  padding: 20px;\n  display: flex;\n  flex-direction: column;\n\n  @media (max-width: 450px){\n    padding: 20px 10px 10px 10px;\n  }\n  \n  \n  .head {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    height: 100px;\n\n    @media ( max-width: 950px ){\n      margin-top: -20px;\n    }\n\n    .userInfo-container{\n      display: flex;\n      gap: 15px;\n      width: 100%;\n\n      .back-container{\n        display: flex;\n        align-items: center;\n\n        \n        &>svg{\n          height: 35px;\n          width: 35px;\n          \n          @media (min-width: 750px){\n            display: none;\n          }\n        }\n      }\n\n      .img-container{\n        width: 60px;\n        height: 60px;\n        background-color: yellow;\n        border-radius: 50%;\n\n        img{\n          width: 100%;\n          border-radius: 50%;\n        }\n      }\n\n      &>div:last-child{\n        display: flex;\n        flex-direction: column;\n        justify-content: center;\n        overflow: none;\n        overflow: hidden;\n\n        &>span:first-child{\n          font-weight: bold;\n          font-size: 20px;\n          text-overflow: ellipsis;\n          overflow: hidden;\n\n          &+span{\n            font-size: 10px;\n            font-style: italic;\n            color: #d5d5d5;\n          }\n        }\n      }\n    }\n\n    .functionality-container{\n      display: flex;\n      display: none;\n      gap: 40px;\n      align-items: center;\n      justify-content: space-between;\n\n      ul{\n        display: flex;\n        list-style: none;\n        gap: 20px;\n  \n        // li{\n        //   margin: 10px;\n        // }\n        svg{\n          width: 20px;\n          height: 20px;\n        }\n      }\n\n      .close-message{\n        svg{\n          width: 30px;\n          height: 30px;\n        }\n      }\n\n      svg{\n        transform: scale(1);\n        transition: 0.2s ease;\n      }\n      li, .close-message{\n        &:hover svg{\n          transform: scale(1.2);\n        }\n      }\n    }\n  }\n\n\n  .background-container{\n    background-color: var(--thm-transparent-color);\n    border-radius: 10px;\n    padding: 10px 40px;\n    height: calc(100% - 100px);\n    display: flex;\n    gap: 10px;\n    flex-direction: column;\n    overflow: hidden;  \n\n    @media (max-width: 950px){\n      height: calc(100% - 80px);\n      padding: 10px 20px;\n    }\n\n    @media (max-width: 450px){\n      padding: 10px;\n    }\n\n\n    .messages {\n      height: calc(100% - 100px);\n      flex-shrink: 1;\n      flex-grow: 1;\n      position: relative;\n      margin-right: -20px;\n\n      @media (max-width: 450px){\n        margin-right: -5px;\n      }\n\n      .msg-404{\n        height: 100%;\n        width: 100%;\n        margin: 0px;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        font-size: 30px;\n        color: var(--thm-transparent-color);\n      }\n\n\n      &.scrolling-down + .text-editor::before{\n        opacity: 1;\n      }\n    }\n\n    \n\n    .text-editor {\n      display: flex;\n      justify-content: space-between;\n      align-items: flex-end;\n      flex-shrink: 0;\n      flex-grow: 0;\n      padding: 10px 0px;\n      position: relative;\n      gap: 10px;\n\n      @media (max-width: 450px){\n        padding: 0;\n      }\n\n      //for shadow below msg container\n      &::before{\n        --height: 10px;\n        content: "";\n        display: block;\n        position: absolute;\n        top: calc(-10px - var(--height));\n        left: -50%;\n        width: 200%;\n        height: var(--height);\n        background: linear-gradient(0deg,var(--thm-background-color), transparent);\n        opacity: 0;\n        pointer-event: none;\n        transition: 0.15s ease;\n      }\n\n      \n      &>.wrap-auto-resize{\n        width: 100%;\n        min-height: 40px;\n        display: grid;\n        padding: 8px;\n        border-radius: 8px;\n        border: 1px solid var(--thm-primary-color);\n        flex-grow: 1;\n        flex-shrink: 1;\n\n        &>.textarea-cpy{\n          white-space: pre-wrap;\n          word-break: break-word;\n          visibility: hidden;\n        }\n\n        &>textarea, &>.textarea-cpy {\n          width: calc(100% + 10px);\n          min-height: 100%;\n          max-height: 6.2em;\n          margin-right: -8px; //equal to parent padding\n          border: none;\n          outline: none;\n          background-color: transparent;\n          font-size: 15px;\n          line-height: 1.25em;\n          resize: none;\n          grid-area: 1/1/2/2;\n        }\n        &>textarea::placeholder{\n          color: var(--thm-transparent2-color);\n        }\n      }\n      \n      \n      &>div:last-child{\n        display: flex;\n        flex-shrink: 0;\n        flex-grow: 0;\n        justify-content: center;\n        align-items: center;\n        \n        button {\n          width: 40px;\n          height: 40px;\n          display: flex;\n          justify-content: center;\n          align-items: center;\n          padding: 10px;\n          background-color: var(--thm-secondary-color);\n          border: none;\n          outline: none;\n          border-radius: 8px;\n\n          &>svg{\n            width: 30px;\n            height: 30px;\n          }\n        }\n      }\n    }\n  }\n  \n\n']))),Zn=a.memo(yn);function Nn(n){n.currentTarget.scrollTo(0,1)}var In=function(){var n=(0,c.v9)((function(n){return n.user})).user,e=(0,c.v9)((function(n){return n.chatNav})).mobileViewSection,t=(0,c.I0)();return(0,a.useEffect)((function(){function e(){g.Z.emit("register-connection",{userId:n.userId,socketId:g.Z.id},(function(n){console.log(n),t((0,u.Rx)(n.onlineUsers))}))}return g.Z.connected?e():g.Z.on("connect",(function(){e()})),g.Z.on("new-user-connected",(function(n){t((0,u.ai)(n))})),g.Z.on("user-disconnected",(function(n){t((0,u.WZ)(n))})),function(){g.Z.off("connect"),g.Z.off("register-connection"),g.Z.off("new-user-connected"),g.Z.off("user-disconnected")}}),[]),(0,a.useEffect)((function(){window.scrollTo(0,1)})),(0,I.jsx)(I.Fragment,{children:(0,I.jsx)(Cn,{onLoad:Nn,children:(0,I.jsxs)("div",{className:("currentChatContainer"===e?"show-current-message-container ":"")+"container",children:[(0,I.jsx)("nav",{children:(0,I.jsx)(q,{})}),(0,I.jsx)("div",{className:"chat-container",children:(0,I.jsx)(W,{})}),(0,I.jsx)("div",{className:"current-chat-container",children:(0,I.jsx)(Zn,{})})]})})})},Cn=s.ZP.section(jn||(jn=(0,i.Z)(["\n --thm-svg-color: #9e9e9e;\n --thm-svg-active-color: var(--thm-primary-color); \n\n  width: 100vw;\n  height: 100vh;\n  height: var(--calculated-vh, 100vh);\n  overflow: hidden;\n  position: relative;\n\n  &:fullscreen, &::backdrop{\n    background-color: var(--thm-background-color);\n  }\n\n  *{\n    color: white;\n  }\n\n  .container {\n    display: flex;\n    height: 100%;\n    width: 100%;\n    transition: 0.2s ease;\n\n    @media (max-width: 950px){\n      overflow: hidden;\n      display: grid;\n      grid-template-columns: 0.75fr 1fr;\n      grid-auto-rows: 100%;\n    }\n    @media (max-width: 750px){\n      position: absolute;\n      top: 0;\n      left: 0;\n      grid-template-columns: 1fr 1fr;\n      width: 200%;\n    }\n\n    &.show-current-message-container{\n      @media( max-width: 750px){\n        left: -100%;\n      }\n    }\n\n    &>nav{\n      height: 100%;\n      @media (max-width: 950px){\n        display: none;\n      }\n    }\n\n    .chat-container {\n      flex-basis: 400px;\n      width: 400px;\n      min-width: 350px;\n      height: 100%;\n      overflow-y: auto;\n      overflow-x: hidden;\n\n      @media (max-width: 950px){\n        width: 100%;\n        grid-area: 1/1/2/2;\n      }\n    }\n\n    .current-chat-container {\n      width: calc(100% - 80px - 400px);\n      min-width: 350px;\n      height: 100%;\n\n      @media (max-width: 950px){\n        width: 100%;\n        grid-area: 1/2/2/3;\n      }\n    }\n  }\n"]))),Mn=a.memo(In)}}]);
//# sourceMappingURL=689.aaca0933.chunk.js.map